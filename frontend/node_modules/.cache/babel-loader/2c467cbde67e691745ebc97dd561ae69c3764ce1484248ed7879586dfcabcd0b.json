{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import{useNavigate,useParams}from'react-router-dom';import{FORMAT_CODES}from'./../../constants/matchStatusConstants';import{useSeriesMatchList}from'./../../context/SeriesMatchListContext';import MatchCard from'./../MatchCard';import{jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";export default function SeriesMatchesTab(){const{seriesId}=useParams();const{seriesMatches,loadingMatches}=useSeriesMatchList();const[matches,setMatches]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{const processMatches=async()=>{setLoading(true);try{const stageId=parseInt(seriesId);const nextStageId=stageId+1;// Fetch both current and next stage metadata\nconst[stageRes,nextStageRes]=await Promise.allSettled([axios.get(\"/api/stages/\".concat(stageId)),axios.get(\"/api/stages/\".concat(nextStageId))]);const stage=stageRes.status==='fulfilled'?stageRes.value.data.data.data:null;const nextStage=nextStageRes.status==='fulfilled'?nextStageRes.value.data.data.data:null;let stageIds=[stageId];const shouldIncludeNext=stage&&nextStage&&stage.league_id===nextStage.league_id&&stage.code===nextStage.code&&!FORMAT_CODES.includes((stage.code||'').toUpperCase());if(shouldIncludeNext){stageIds.push(nextStageId);}// Filter matches from context that match confirmed stageIds\nconst filtered=seriesMatches.filter(m=>stageIds.includes(m.stage_id));setMatches(filtered);}catch(err){console.error('Error processing matches from context:',err);setMatches([]);}finally{setLoading(false);}};processMatches();},[seriesId,seriesMatches]);return/*#__PURE__*/_jsx(_Fragment,{children:loading&&loadingMatches?/*#__PURE__*/_jsx(\"p\",{children:\"Loading matches...\"}):/*#__PURE__*/_jsx(\"div\",{className:\"series-match-cards-row\",children:matches.map(match=>/*#__PURE__*/_jsx(MatchCard,{match:match},match.id))})});}","map":{"version":3,"names":["React","useEffect","useState","axios","useNavigate","useParams","FORMAT_CODES","useSeriesMatchList","MatchCard","jsx","_jsx","Fragment","_Fragment","SeriesMatchesTab","seriesId","seriesMatches","loadingMatches","matches","setMatches","loading","setLoading","processMatches","stageId","parseInt","nextStageId","stageRes","nextStageRes","Promise","allSettled","get","concat","stage","status","value","data","nextStage","stageIds","shouldIncludeNext","league_id","code","includes","toUpperCase","push","filtered","filter","m","stage_id","err","console","error","children","className","map","match","id"],"sources":["/Users/ashwin.r1/Downloads/sportmonks-api-cricket-website/frontend/src/components/series/SeriesMatchesTab.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { FORMAT_CODES } from './../../constants/matchStatusConstants';\nimport { useSeriesMatchList } from './../../context/SeriesMatchListContext';\nimport MatchCard from './../MatchCard';\n\nexport default function SeriesMatchesTab() {\n  const { seriesId } = useParams();  \n  const { seriesMatches, loadingMatches } = useSeriesMatchList();\n  const [matches, setMatches] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const processMatches = async () => {\n      setLoading(true);\n\n      try {\n        const stageId = parseInt(seriesId);\n        const nextStageId = stageId + 1;\n\n        // Fetch both current and next stage metadata\n        const [stageRes, nextStageRes] = await Promise.allSettled([\n          axios.get(`/api/stages/${stageId}`),\n          axios.get(`/api/stages/${nextStageId}`)\n        ]);\n\n        const stage = stageRes.status === 'fulfilled' ? stageRes.value.data.data.data : null;\n        const nextStage = nextStageRes.status === 'fulfilled' ? nextStageRes.value.data.data.data : null;\n\n        let stageIds = [stageId];\n\n        const shouldIncludeNext =\n          stage &&\n          nextStage &&\n          stage.league_id === nextStage.league_id &&\n          stage.code === nextStage.code &&\n          !FORMAT_CODES.includes((stage.code || '').toUpperCase());\n\n        if (shouldIncludeNext) {\n          stageIds.push(nextStageId);\n        }\n\n        // Filter matches from context that match confirmed stageIds\n        const filtered = seriesMatches.filter(m => stageIds.includes(m.stage_id));\n        setMatches(filtered);\n      } catch (err) {\n        console.error('Error processing matches from context:', err);\n        setMatches([]);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    processMatches();\n  }, [seriesId, seriesMatches]);\n\n  return (\n    <>\n      {loading && loadingMatches ? (\n        <p>Loading matches...</p>\n      ) : (\n        <div className=\"series-match-cards-row\">\n          {matches.map(match => (\n            <MatchCard key={match.id} match={match} />\n          ))}\n        </div>\n      )}\n    </>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}